%!TEX program = lualatex
\documentclass[a4paper,openany,oneside,12pt]{report}
\usepackage[left=3cm,right=2cm,top=2.5cm,bottom=2.5cm]{geometry}
\setcounter{secnumdepth}{4} % Para que LaTeX numere hasta el cuarto nivel

% ------------------- Paquetes: Codificación e Idioma -------------------
\usepackage[spanish]{babel}
\renewcommand{\shorthandsspanish}{} 
\addto{\captionsspanish}{\def\chaptername{}}
\addto\captionsspanish{
  \renewcommand{\listtablename}{Índice de tablas}
}

% ------------------- Paquetes: Fuentes y Estilos -------------------
\usepackage{fontspec}
\usepackage{fontsize}
\usepackage{setspace}
\usepackage{parskip}
\usepackage{xcolor}
\usepackage{colortbl}
\usepackage[hidelinks]{hyperref}
\usepackage{import}
\usepackage[apaciteclassic]{apacite}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{graphicx}
\usepackage{etoolbox} % Añadido para el ajuste del comando \chapter

% ------------------- Configuraciones de Fuente -------------------
\setmainfont[Path=/usr/share/fonts/TTF/,
    BoldItalicFont=calibriz.ttf,
    BoldFont      =calibrib.ttf,
    ItalicFont    =calibrii.ttf,
    FontFace={l}{n}{Font=calibril.ttf},
    FontFace={l}{it}{Font=calibrili.ttf}
    ]{calibri.ttf}
\newcommand{\textlight}[1]{{\fontspec{calibril.ttf} #1}}
\newcommand{\textlightit}[1]{{\fontspec{calibrili.ttf} #1}}

% ------------------- Configuraciones de Página y Estilo -------------------
\definecolor{azul_unir}{RGB}{0, 152, 205}
\setlength{\parskip}{6pt plus 1pt minus 1pt}
\setlength{\parindent}{0pt}
\onehalfspacing
\pagestyle{fancy}
\fancyhf{}
\fancyhead[R]{\textlight{\small \autor \\ \titulo}}
\fancyfoot[C]{\thepage}
\bibliographystyle{apacite}

\fancypagestyle{plain}{
  \fancyhf{} 
  \fancyhead[R]{\textlight{\small \autor \\ \titulo}}
  \fancyfoot[C]{\thepage}
  \renewcommand{\headrulewidth}{0.4pt} 
  \renewcommand{\footrulewidth}{0pt}  
}

\patchcmd{\chapter}{\thispagestyle{plain}}{\pagestyle{fancy}\thispagestyle{fancy}}{}{}

% Formateo de títulos
\setstretch{1.5}

% Título de primer nivel (Título 1)
\titleformat{\chapter}[block]
{\fontsize{18pt}{25pt}\selectfont\color{azul_unir}\textlight}
{\thechapter.\ }
{1em}
{}
\titlespacing*{\chapter}{0pt}{0pt}{6pt}

% Título de segundo nivel (Título 2)
\titleformat{\section}
{\fontsize{14pt}{21pt}\selectfont\color{azul_unir}\textlight}
{\thesection}
{1em}
{}
\titlespacing*{\section}{0pt}{6pt}{0pt}

% Título de tercer nivel (Título 3)
\titleformat{\subsection}
{\fontsize{12pt}{12pt}\selectfont\bfseries}
{\thesubsection}
{1em}
{}
\titlespacing*{\subsection}{0pt}{0pt}{0pt}

% Título de cuarto nivel (Título 4)
\titleformat{\subsubsection}
{\fontsize{12pt}{12pt}\selectfont\normalfont}
{\thesubsubsection}
{1em}
{}
\titlespacing*{\subsubsection}{0pt}{0pt}{0pt}

% ------------------- Comandos y Entornos Personalizados -------------------
\newcommand{\titulo}{Síntesis sonora en SuperCollider con modelos de lenguaje}
\newcommand{\autor}{Carlos Arturo Guerra Parra}
\AtBeginDocument{\renewcommand{\bibname}{Referencias bibliográficas}}

% ------------------- Contenido del Documento -------------------
\begin{document}

  \import{./portada/}{portada.tex}
  \tableofcontents
  \listoffigures 
  \listoftables 
  \import{./capitulos/}{introduccion.tex}
  \import{./capitulos/}{marco_teorico.tex}
  \import{./capitulos/}{metodologia.tex}
  \import{./capitulos/}{cuerpo.tex}
  \import{./capitulos/}{resultados.tex}
  \import{./capitulos/}{conclusiones.tex}
  \import{./capitulos/}{limitaciones_prospectiva.tex}
  \import{./capitulos/}{bibliografia.tex}
  \import{./anexos/}{anexos.tex}

\end{document}
